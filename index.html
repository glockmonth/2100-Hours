<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>2100 Hours Leaderboard</title>
<style>
body {font-family: Arial, sans-serif; background:#0a0a0a; color:#fff; margin:0; padding:2rem;}
h1 {text-align:center; margin-bottom:2rem; color:#ff0000;}
table {width:100%; border-collapse: collapse; max-width:800px; margin:0 auto;}
th, td {padding:0.8rem 1rem; text-align:left; border-bottom:1px solid #444;}
th {background:#222; color:#ff0000;}
tr:nth-child(even){background:#111;}
td.hours {text-align:right; color:#ffd700; font-weight:bold;}
</style>
</head>
<body>

<h1>2100 Weekly Hours Leaderboard</h1>
<table>
<thead>
<tr>
<th>Member Name</th>
<th>Hours This Week</th>
</tr>
</thead>
<tbody id="leaderboard-body">
<!-- Leaderboard rows go here -->
</tbody>
</table>

<script>
const CSV_URL = "./statbot.csv"; // make sure your CSV is named statbot.csv

// Parse CSV into objects
function parseCSV(csv) {
    const lines = csv.trim().split("\n");
    const headers = lines.shift().split(",");
    return lines.map(line => {
        const values = line.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
        const obj = {};
        headers.forEach((h, i) => obj[h.trim()] = values[i]?.replace(/^"|"$/g,'') || '');
        return obj;
    });
}

// Display leaderboard
function displayLeaderboard(data) {
    // Sort by count descending
    const sorted = data.sort((a,b) => Number(b.count) - Number(a.count));
    const tbody = document.getElementById("leaderboard-body");
    tbody.innerHTML = "";
    sorted.forEach(u => {
        tbody.innerHTML += `
        <tr>
            <td>${u.username}</td>
            <td class="hours">${Number(u.count).toFixed(2)}</td>
        </tr>`;
    });
}

// Fetch CSV and show
fetch(CSV_URL)
    .then(res => res.text())
    .then(csv => {
        const data = parseCSV(csv);
        displayLeaderboard(data);
    })
    .catch(err => console.error("Failed to load CSV:", err));
</script>

</body>
</html>
